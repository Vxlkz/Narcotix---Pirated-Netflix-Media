<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Narcotix | Pirated Netflix</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <script type="text/javascript" src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js"></script>
  <style>
    /* Your existing styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background-color: #141414;
      color: white;
      overflow-x: hidden;
    }

    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background-color: #141414;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
    }

    .navbar img {
      height: 40px;
    }

    .right-icons i {
      margin-left: 20px;
      cursor: pointer;
    }

    .search-box {
      position: fixed;
      top: 70px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #333;
      padding: 10px;
      display: none;
    }

    .search-box input {
      padding: 10px;
      background-color: #444;
      border: 1px solid #555;
      color: white;
      width: 300px;
    }

    .movie-row {
      display: flex;
      padding: 20px;
      overflow-x: scroll;
      margin-top: 100px;
    }

    .movie-row img {
      height: 200px;
      margin-right: 10px;
      cursor: pointer;
    }

    #scrollEnd {
      height: 200px;
    }

    #movieEmbed {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1001;
      width: 80%;
      height: 80%;
      background-color: black;
    }

    #movieIframe {
      width: 100%;
      height: 100%;
    }

    #closeBtn {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #f00;
      color: white;
      border: none;
      font-size: 30px;
      cursor: pointer;
    }

    .screen-share-icon {
      font-size: 28px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div class="navbar" id="navbar">
    <img alt="Logo" src="https://i.ibb.co/gjBrfcB/c3f62d75a54648c3fcec0d618c004e66.png" width="120" />
    <div class="right-icons">
      <i class="fas fa-search" onclick="toggleSearchBox()"></i>
      <i class="fas fa-tv screen-share-icon" onclick="startScreenSharing()" title="Cast This Page"></i>
      <i class="fas fa-bell"></i>
      <i class="fas fa-user"></i>
    </div>
  </div>

  <div class="search-box" id="searchBox">
    <input type="text" placeholder="Search..." />
  </div>

  <div class="movie-row" id="movieRowAction"></div>
  <div class="movie-row" id="movieRowAdventure"></div>
  <div class="movie-row" id="movieRowAnimation"></div>
  <div class="movie-row" id="movieRowComedy"></div>
  <div class="movie-row" id="movieRowCrime"></div>
  <div class="movie-row" id="movieRowDocumentary"></div>
  <div class="movie-row" id="movieRowDrama"></div>
  <div class="movie-row" id="movieRowFamily"></div>
  <div class="movie-row" id="movieRowFantasy"></div>
  <div class="movie-row" id="movieRowHorror"></div>
  <div class="movie-row" id="movieRowMusic"></div>
  <div class="movie-row" id="movieRowMystery"></div>
  <div class="movie-row" id="movieRowRomance"></div>
  <div class="movie-row" id="movieRowThriller"></div>
  <div class="movie-row" id="movieRowWar"></div>
  <div class="movie-row" id="movieRowWestern"></div>

  <div id="scrollEnd"></div>

  <div id="movieEmbed">
    <iframe id="movieIframe" src="" frameborder="0" allowfullscreen></iframe>
    <button id="closeBtn" onclick="closeEmbed()">Ã—</button>
  </div>

  <script>
    const apiKey = 'd4d5dc37aeb71914016166a958fbe3db';

    function fetchMoviesByGenre(genreId, rowId) {
      fetch(`https://api.themoviedb.org/3/discover/movie?api_key=${apiKey}&with_genres=${genreId}&language=en-US&page=1`)
        .then(response => response.json())
        .then(data => {
          const movies = data.results;
          const row = document.getElementById(rowId);
          row.innerHTML = '';
          movies.forEach(movie => {
            const movieElement = document.createElement('img');
            movieElement.src = `https://image.tmdb.org/t/p/w500${movie.poster_path}`;
            movieElement.alt = movie.title;
            movieElement.onclick = () => openMovieEmbed(movie.id);
            row.appendChild(movieElement);
          });
        });
    }

    function openMovieEmbed(movieId) {
      // Here you would link to a streaming service for the movie
      const streamingURL = `https://www.some-streaming-site.com/movie/${movieId}`; // Replace with your streaming URL or service
      const iframe = document.getElementById("movieIframe");
      iframe.src = streamingURL;
      document.getElementById("movieEmbed").style.display = "block";
    }

    function closeEmbed() {
      document.getElementById("movieEmbed").style.display = "none";
      const iframe = document.getElementById("movieIframe");
      iframe.src = "";
    }

    function toggleSearchBox() {
      const searchBox = document.getElementById("searchBox");
      searchBox.style.display = searchBox.style.display === "block" ? "none" : "block";
    }

    // Screen sharing logic
    function startScreenSharing() {
      if (navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {
        navigator.mediaDevices.getDisplayMedia({ video: true })
          .then(stream => {
            castScreenToDevice(stream);
          })
          .catch(err => {
            console.log("Screen sharing failed: ", err);
          });
      } else {
        alert("Screen sharing is not supported in this browser.");
      }
    }

    // Google Cast API initialization
    function initializeCastApi() {
      cast.framework.CastContext.getInstance().setOptions({
        receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,
        autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED
      });
    }

    window['__onGCastApiAvailable'] = function (loaded, errorInfo) {
      if (loaded) {
        initializeCastApi();
      } else {
        console.log("Google Cast API not available:", errorInfo);
      }
    };

    // Function to cast screen to Chromecast device
    function castScreenToDevice(stream) {
      const castSession = cast.framework.CastContext.getInstance().getCurrentSession();
      if (castSession) {
        const mediaInfo = new chrome.cast.media.MediaInfo('screen', 'video/mp4');
        mediaInfo.stream = stream;
        const request = new chrome.cast.media.LoadRequest(mediaInfo);
        castSession.loadMedia(request, function () {
          console.log('Screen successfully casted to TV');
        }, function (error) {
          console.log('Error casting screen to TV:', error);
        });
      } else {
        alert("No Chromecast device is available.");
      }
    }

    // Fetch movies for each genre
    fetchMoviesByGenre(28, 'movieRowAction');
    fetchMoviesByGenre(12, 'movieRowAdventure');
    fetchMoviesByGenre(16, 'movieRowAnimation');
    fetchMoviesByGenre(35, 'movieRowComedy');
    fetchMoviesByGenre(80, 'movieRowCrime');
    fetchMoviesByGenre(99, 'movieRowDocumentary');
    fetchMoviesByGenre(18, 'movieRowDrama');
    fetchMoviesByGenre(10751, 'movieRowFamily');
    fetchMoviesByGenre(14, 'movieRowFantasy');
    fetchMoviesByGenre(27, 'movieRowHorror');
    fetchMoviesByGenre(10402, 'movieRowMusic');
    fetchMoviesByGenre(9648, 'movieRowMystery');
  </script>
</body>
</html>
